
@{
    ViewBag.Title = "SampleIndex";
    Layout = "~/Views/Shared/_Layout.cshtml";

    string loginIDs = clsApplicationSetting.GetSessionValue("LoginID");
}

<style>

    .ag-header-group-cell:not(.ag-column-resizing) + .ag-header-group-cell:not(.ag-column-hover):not(.ag-header-cell-moving):hover, .ag-header-group-cell:not(.ag-column-resizing) + .ag-header-group-cell:not(.ag-column-hover).ag-column-resizing, .ag-header-cell:not(.ag-column-resizing) + .ag-header-cell:not(.ag-column-hover):not(.ag-header-cell-moving):hover, .ag-header-cell:not(.ag-column-resizing) + .ag-header-cell:not(.ag-column-hover).ag-column-resizing, .ag-header-group-cell:first-of-type:not(.ag-header-cell-moving):hover, .ag-header-group-cell:first-of-type.ag-column-resizing, .ag-header-cell:not(.ag-column-hover):first-of-type:not(.ag-header-cell-moving):hover, .ag-header-cell:not(.ag-column-hover):first-of-type.ag-column-resizing {
        background-color: #44488c !important;
    }

    #customLoader {
        background: rgba(0, 0, 0, 0.7) !important;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .ag-header-cell, .ag-header-group-cell {
        padding: 0px 5px !important;
    }

    .ag-header-group-cell-label, .ag-cell-label-container {
        padding: 0px 0px !important;
    }

    #customLoader img {
        width: 40px;
        height: 40px
    }

    .ag-text-field-input {
        color: #000 !important;
        font-size: 10px !important
    }
    /* Styles for the alert box */
    .custom-alert {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border-radius: 10px;
        display: none;
        width: auto;
        z-index: 1000;
        overflow: inherit !important;
    }

        .custom-alert .modal-body {
            padding-bottom: 0px;
            overflow: scroll;
            height: 400px;
            overflow-x: hidden;
        }

    .custom-lg {
        width: 630px;
        background: #fff;
        font-size: 10px;
        border-radius: 8px
    }

    .custom-alert table {
        width: 100%;
        border-collapse: collapse;
    }

    .custom-alert th, .custom-alert td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
    }

    .custom-alert th {
        background: #2f3261;
        color: #fff;
    }

    .custom-alert th, .custom-alert td {
        border: 1px solid #ddd;
        padding: 2px 5px !important;
        text-align: left;
        word-break: break-all;
        vertical-align: top;
        line-height: 25px;
        font-size: 12px;
        text-transform: lowercase;
    }

    .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        z-index: 999;
    }
</style>

<ul class="tablink">
    <li><a href="SampleIndex?auth=@ViewBag.Auth" id="open" class="nav-link active">Active</a></li>
    <li><a href="SampleIndexDelete?auth=@ViewBag.Auth" id="dispatch" class="nav-link">Dispatch</a></li>

</ul>
<!-- page title --/.-->
<div class="pagetitle gap-bottom d-flex justify-content-between">   
    <h1 class="m-0 d-flex ">
        Sample Registration <div class="ml-2"><svg data-toggle="tooltip" title="This page shows list of all the Active Samples that have not been dispatched yet." width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_423_173595)"><path d="M10.0001 18.3334C14.6025 18.3334 18.3334 14.6025 18.3334 10.0001C18.3334 5.39771 14.6025 1.66675 10.0001 1.66675C5.39771 1.66675 1.66675 5.39771 1.66675 10.0001C1.66675 14.6025 5.39771 18.3334 10.0001 18.3334Z" stroke="#25282B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M10 13.3333V10" stroke="#25282B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M10 6.66675H10.0083" stroke="#25282B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></g><defs><clipPath id="clip0_423_173595"><rect width="20" height="20" fill="white"></rect></clipPath></defs></svg></div>
    </h1>
    <div class="align-self-center heading-action-btn w-100-slt primary-color-slt">
        <a href="#" class="btn border-r-8" data-toggle="tooltip" id="exportExcel" title="Download Excel Report"><img src="~/assets/images/icons/help/filter/download-icon.svg" class="btn-icon m-0"></a>
        <a href="" data-toggle="modal" data-target="#printsample" class="btn actionbtn iconbtn"><img src="../../assets/images/icons/help/print-white-icon.svg" alt=""></a>
        <a href="AddSample?auth=@ViewBag.Auth" class="btn mr-2 actionbtn border-r-8"><img src="../../assets/images/icons/help/add-white-icon.png" class="btn-icon"><span class="d-none-smyyy">Add New Sample</span></a>
    </div>
</div>
<!--  -->

<div class="secondary-light-bg third-container">
    <div class="row table-filter">
        <div class="col-lg-2 col-md-3 col-sm-3 form-group" style="display: none;">
            <label for="role">Customer </label>
            <select class="form-control applyselect" id="ddlCustomer">
            </select>
        </div>

        @*<div class="col-lg-2 col-md-3 col-sm-3 form-group">
                <label for="role">Sales Person </label>
                <select class="form-control applyselect">

                    <option>All</option>
                    <option>Sai Ram</option>
                    <option>Ankit Agarwal</option>
                    <option>Deepak Agarwal</option>
                </select>
            </div>*@

        <div class="col-lg-2 col-md-3 col-sm-3 form-group" style="display: none;">
            <label for="role">Client Brand Type </label>
            <select class="form-control applyselect" id="ddlBrandType">
            </select>
        </div>

        <div class="col-lg-2 col-md-3 col-sm-3 form-group" style="display: none;">
            <label for="role">Order Size</label>
            <select class="form-control applyselect" id="ddlOrderSize">
            </select>
        </div>

        <div class="col-lg-2 col-md-3 col-sm-3 form-group" style="display: none;">
            <label for="role">Status </label>
            <select class="form-control applyselect" id="ddlStatus">

                <option value="All">All</option>
                <option value="2">Approved</option>
                <option value="1">Pending</option>
                <option value="3">Rejected</option>
                <option value="4">Returned</option>
            </select>
        </div>

        <div class="col-lg-2 col-md-3 col-sm-3 form-group" style="display: none;">
            <label for="role">Sample Type</label>
            <select class="form-control applyselect" id="ddlSampleType">
            </select>
        </div>

        <div class="col-lg-2 col-md-3 col-sm-3 form-group" style="display: none;">
            <label for="role">Sales Person</label>
            <select class="form-control applyselect" id="ddlSalesPerson">
            </select>
        </div>

        @*<div class="col-lg-2 col-md-3 col-sm-3 form-group">
                <label for="role">Feedback Status </label>
                <select class="form-control applyselect">

                    <option>All</option>

                </select>
            </div>*@

        <div class="col-sm-2 ml-auto form-group">

            <div class="searchbox">
                <label style="" for="role"></label>
                <div class="search w-300">
                    <label class="icon" for="globalSearch"><img src="../../assets/images/icons/help/search-icon.png" class="icon-sm"></label>
                    <input type="text" id="globalSearch" class="form-control d-inline-block" placeholder="Global Search...">
                </div>

            </div>

        </div>

    </div>
    <!--  -->
    <!--<div class="table-responsive">
        <table id="sampleTable" class="display rstable dgntable dataTable no-footer">
            <thead>
                <tr>-->
    @*<th width="55">SR No</th>*@
    <!--<th width="90">Sample Id</th>
        <th width="150">Customer Name</th>
        <th width="100">Brand Type</th>
        <th width="100">Order Values</th>
        <th width="80">Date</th>
        <th width="120">Sales Person</th>
        <th width="60">Order</th>
        <th width="135">Sample <span class="d-block">Type</span></th>


        <th width="80">Feedback <span class="d-block">Status</span></th>
        <th width="60">Action</th>

    </tr>

    <tr  class="searchfilter">-->
    @*<th></th>*@
    <!--<th>
                        <div class="filterdgn">
                            <input type="text" class="filter-input" id="txtSampleId"
                                   placeholder="Search"> <label for="search" class="m-0">
                                <img src="~/assets/images/icons/help/search-icon.png"
                                     class="filtersearchincon" />
                            </label>
                        </div>
                    </th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                    <th></th>
                </tr>

            </thead>

        </table>
    </div>-->


    <div class="grid-wrapper" style="padding-top: 40px">
        <div id="myGrid" class="ag-theme-alpine agrid-dgn" style="height: 600px"></div>
    </div>


    <!--  -->
</div>


<div class="modal" id="deletepopup" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-dialog-centered modal-default">
        <div class="modal-content ">



            <!-- Modal body -->
            <div class="modal-body">
                <div class="warningmsg">
                    <img src="../../assets/images/icons/help/warning-icon.svg" class="warningicon">
                    <h6 class="text-center">Cancel Sample <enum id="sample_name"></enum></h6>
                    <span class="d-block">Are you sure want to cancel <enum id="sample_name1"></enum> ?</span>

                </div>
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-lg cancelbtn radius-24" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-lg actionbtn radius-24" onclick="DeleteSampleDet()">Delete</button>
            </div>

        </div>
    </div>
</div>

<div id="yourModalContainer"></div>


<div class="modal" id="printsample" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg modal-dialog-scrollable modal-dialog-centered">
        <div class="modal-content">

            <div class="modal-header">
                <h4 class="modal-title text-center w-100">Print Sample Sheet</h4>
                <button type="button" class="close" data-dismiss="modal"><img src="../../assets/images/icons/help/close-icon.png" class="closeicon"></button>
            </div>

            <div class="modal-body">

                <!-- Nav tabs -->
                <ul class="nav nav-tabs tabsnew">
                    <li class="nav-item">
                        <a class="nav-link active" data-toggle="tab" onclick="setNew()" href="#new">New</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab" onclick="setAdv()" href="#advance">Advance</a>
                    </li>
                </ul>

                <!-- Tab panes -->
                <div class="tab-content">
                    <div class="tab-pane container active" id="new">
                        <!--  -->
                        <div class="row">
                            <div class="col-sm-6 form-group">
                                <label>Select Sample Categery<sup>*</sup></label>
                                <select class="form-control applyselect Mandatory" id="ddlsamplecate" onchange="HideErrorMessage(this)">
                                </select>
                                <span id="spddlsamplecate" class="text-danger field-validation-error" style="display:none;">Hey, You missed this field!!</span>
                            </div>
                            <div class="col-sm-6 form-group">
                                <label>Date(From)</label>
                                <div class="input-group">
                                    <input type="text" class="datepicker form-control" readonly id="txtSampleCreateDate" placeholder="DD/MM/YYYY" value="15/02/2025">

                                    <span class="clear-date" style="display:block">×</span>
                                    <div class="input-group-append ">
                                        <span class="input-group-text bg-white"><img src="../../assets/images/icons/help/calendar-icon.svg" alt=""></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--  -->
                    </div>
                    <div class="tab-pane container fade" id="advance">
                        <!--  -->
                        <div class="row">
                            <div class="col-sm-12 form-group">
                                <label>Select Sample Categery</label>
                                <!--  -->
                                <ul class="list-unstyled mt-3 mb-0 d-flex flex-wrap gap-10 ">

                                    <li>
                                        <input type="radio" id="all" class="radio advtype" name="assign">
                                        <label for="all"> All</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="allexceptoils" class="radio advtype" name="assign">
                                        <label for="allexceptoils">ALL Except OILS</label>
                                    </li>
                                    @*<li>
            <input type="radio" id="allprioritysamples" class="radio advtype" name="assign">
            <label for="allprioritysamples"> All Priority Samples</label>
        </li>

        <li>
            <input type="radio" id="allexceptoilslatest" class="radio advtype" name="assign">
            <label for="allexceptoilslatest">ALL Except OILS Latest</label>
        </li>*@
                                    <li>
                                        <input type="radio" id="allformulationpending" class="radio advtype" name="assign">
                                        <label for="allformulationpending"> All Formulation Pending</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="olis" class="radio advtype" name="assign">
                                        <label for="olis"> OILS</label>
                                    </li>

                                    <li>
                                        <input type="radio" id="modifications" class="radio advtype" name="assign">
                                        <label for="modifications"> MODIFICATIONS</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="generalchanges" class="radio advtype" name="assign">
                                        <label for="generalchanges">GENERAL CHANGES</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="pilot" class="radio advtype" name="assign">
                                        <label for="pilot">Pilot</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="labtest" class="radio advtype" name="assign">
                                        <label for="labtest">Lab Test</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="asperbenchmark" class="radio advtype" name="assign">
                                        <label for="asperbenchmark">AS PER BENCHMARK/NPD 1</label>
                                    </li>

                                    <li>
                                        <input type="radio" id="standardcosmetic" class="radio advtype" name="assign">
                                        <label for="standardcosmetic">STANDARD COSMETIC</label>
                                    </li>


                                    <li>
                                        <input type="radio" id="bigbrand" class="radio advtype" name="assign">
                                        <label for="bigbrand">Big Brand</label>
                                    </li>


                                    <li>
                                        <input type="radio" id="exceptbigbrand" class="radio advtype" name="assign">
                                        <label for="exceptbigbrand">Except Big Brand</label>
                                    </li>


                                </ul>
                                <!--  -->
                            </div>
                            <div class="col-md-4 col-sm-6 form-group">
                                <label>Date(From)<sup>*</sup></label>
                                <div class="input-group">
                                    <input type="text" class="datepicker form-control Mandate" onblur="HideErrorMessage(this)" id="txtFromDate" placeholder="DD/MM/YYYY" value="">
                                    <span class="clear-date" >×</span>
                                    <div class="input-group-append ">
                                        <span class="input-group-text bg-white"><img src="../../assets/images/icons/help/calendar-icon.svg" alt=""></span>
                                    </div>
                                </div>
                                <span id="sptxtFromDate" class="text-danger field-validation-error" style="display:none;">Hey, You missed this field!!</span>
                            </div>
                            <div class="col-md-4 col-sm-6 form-group">
                                <label>Date(To)<sup>*</sup></label>
                                <div class="input-group">
                                    <input type="text" class="datepicker form-control Mandate" onblur="HideErrorMessage(this)" id="txtToDate" placeholder="DD/MM/YYYY" value="" readonly>
                                    <span class="clear-date" >×</span>
                                    <div class="input-group-append ">
                                        <span class="input-group-text bg-white"><img src="../../assets/images/icons/help/calendar-icon.svg" alt=""></span>
                                    </div>
                                </div>
                                <span id="sptxtToDate" class="text-danger field-validation-error" style="display:none;">Hey, You missed this field!!</span>
                            </div>
                            @*<div class="col-md-4 col-sm-12 form-group">
                                    <label>Chemist Name</label>
                                    <select class="form-control applyselect select2-hidden-accessible" tabindex="-1" aria-hidden="true">
                                        <option value="" selected="">Select</option>
                                        <option value="">Chemist Name</option>
                                    </select><span class="select2 select2-container select2-container--default" dir="ltr" style="width: auto;"><span class="selection"><span class="select2-selection select2-selection--single" role="combobox" aria-haspopup="true" aria-expanded="false" tabindex="0" aria-labelledby="select2-bw8l-container"><span class="select2-selection__rendered" id="select2-bw8l-container" title="Select">Select</span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span></span></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>
                                </div>*@
                        </div>
                        <!--  -->
                    </div>

                </div>


            </div>

            <div class="modal-footer">
                <button class="btn btn-lg actionbtn" onclick="getSampleIdForPrint()">Print Sample</button>
            </div>


        </div>
    </div>
</div>

<style>
    #globalSearch {
        display: none
    }

    .ag-header-cell-menu-button:not(.ag-header-menu-always-show) {
        transition: opacity 0.2s;
        opacity: 1;
        color: #fff;
    }

    .ag-icon::before {
        color: #fff;
    }

    .ag-theme-balham .ag-header-cell-label {
        white-space: normal; /* Allow wrapping in header text */
    }

    .ag-theme-balham {
        overflow-x: auto; /* Avoid extra whitespace */
    }


    .ag-header-cell, .ag-header-group-cell {
        padding-left: var(--ag-cell-horizontal-padding);
        padding-right: var(--ag-cell-horizontal-padding);
        background: #44488c;
        color: #fff !important
    }

    .ag-icon-filter {
        font-family: var(--ag-icon-font-family-filter, var(--ag-icon-font-family));
        font-weight: var(--ag-icon-font-weight-filter, var(--ag-icon-font-weight));
        color: #ffffff !important;
    }
    /* Styles for the alert box */
    .custom-alert {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0px 0px 10px rgba(0,0,0,0.2);
        display: none;
        z-index: 1000;
    }

        .custom-alert table {
            width: 100%;
            border-collapse: collapse;
        }

        .custom-alert th, .custom-alert td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .custom-alert th {
            background-color: #f2f2f2;
        }

    .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        z-index: 999;
    }

    .ag-icon.ag-icon-previous::before {
        content: "\f104"; /* Font Awesome: fa-angle-left */
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        font-size: 14px;
        color: #333;
    }

    .ag-icon.ag-icon-next::before {
        content: "\f105"; /* Font Awesome: fa-angle-right */
        font-family: "Font Awesome 6 Free";
        font-weight: 900;
        font-size: 14px;
        color: #333;
    }
</style>

<script>
    var deleted = false;
     var login_ID = "@loginIDs";


</script>

<script>
    var type = "new";

    function setNew() {
        type = "new";
    }

    function setAdv() {
        type = "adv"
    }

</script>

@*Ag Grid Scripts Start*@
<link href="~/css/Aggrid/Aggrid1.css" rel="stylesheet" />
<link href="~/css/Aggrid/Aggrid2.css" rel="stylesheet" />
<link href="~/css/aggrid/ag-grid.css" rel="stylesheet" />
<link href="~/css/aggrid/ag-theme-alpine.css" rel="stylesheet" />
<script src="~/CommonJS/AgGrid/dist_aggrid_community.js"></script>
<script src="~/CommonJS/AgGrid/aggridCom.min.js"></script>
<script src="~/CommonJS/AgGrid/autotable.umd.min.js"></script>
<script src="~/assets/js/jquery.dataTables.min.js"></script>
<script src="~/CommonJS/AgGrid/jspdf.umd.min.js"></script>
<script src="~/CommonJS/AgGrid/libs.umd.min.js"></script>
<script src="~/assets/js/jquery.dataTables.min.js"></script>
<script src="~/CommonJS/GenericAgGrid.js"></script>
@*Ag Grid Scripts End*@

<script src="~/Areas/ManageSample/DevScript/SampleIndex.js"></script>
<script>
    $(document).ready(function () {
    let lastOpenedInput = null;

    // z-index only
    $('<style>')
        .prop('type', 'text/css')
        .html(`.daterangepicker { z-index: 999999999 !important; }`)
        .appendTo('head');

    // --- ADD: hard lock with !important ---
    function lockAbove(picker, $input) {
        if (!picker || !$input || !$input.length) return;
        const $popup = picker.container;
        const rect = $input[0].getBoundingClientRect();

        // compute desired position ABOVE
        const popupW = $popup.outerWidth();
        const popupH = $popup.outerHeight();
        const winW = window.innerWidth;

        let left = rect.left;
        if (left + popupW > winW - 8) left = Math.max(8, winW - popupW - 8);
        left = Math.max(8, left);

        let top = rect.top - popupH - 6;
        top = Math.max(8, top);

        // force with !important so plugin can't override on re-render
        const st = $popup[0].style;
        st.setProperty('position', 'fixed', 'important');
        st.setProperty('left', left + 'px', 'important');
        st.setProperty('top', top + 'px', 'important');
    }
    // --------------------------------------

    function placeDrpNearInput(picker, $input) {
        if (!picker || !$input || $input.length === 0) return;
        const $popup = picker.container;

        // Reset styles (we'll re-apply with !important)
        $popup.css({ top: '', left: '', right: '', bottom: '', transform: '', position: '' });

        requestAnimationFrame(() => lockAbove(picker, $input));
    }

    // Init
    $('.datepicker').daterangepicker({
        opens: 'right',
        drops: 'up',              // <--- ADD THIS
        singleDatePicker: true,
        showDropdowns: true,
        autoApply: true,
        autoUpdateInput: false,
        parentEl: 'body',
        dropdownParent: 'body',
        locale: { format: 'DD/MM/YYYY' }
    })

        // Set value on apply
        .on('apply.daterangepicker', function (ev, picker) {
            $(this).val(picker.startDate.format('DD/MM/YYYY'));
            $(this).siblings('.clear-date').show();
        })

        // On show: remember input and place above + observe
        .on('show.daterangepicker', function (ev, picker) {
            lastOpenedInput = $(this);
            // be explicit
            picker.drops = 'up';
            placeDrpNearInput(picker, lastOpenedInput);

            // Watch height changes and re-lock
            if ('ResizeObserver' in window) {
                if (window._drpRO) { window._drpRO.disconnect(); window._drpRO = null; }
                const el = picker && picker.container && picker.container[0];
                if (el) {
                    window._drpRO = new ResizeObserver(() => lockAbove(picker, lastOpenedInput));
                    window._drpRO.observe(el);
                }
            }
        });

    // Reposition when month/year dropdown changes (after re-render)
    $(document).on('change', 'select.monthselect, select.yearselect', function () {
        if (!lastOpenedInput) return;
        const picker = lastOpenedInput.data('daterangepicker');
        setTimeout(() => lockAbove(picker, lastOpenedInput), 0);
    });

    // ALSO: catch prev/next button clicks explicitly
    $(document).on('click', '.daterangepicker .drp-calendar .prev, .daterangepicker .drp-calendar .next', function () {
        if (!lastOpenedInput) return;
        const picker = lastOpenedInput.data('daterangepicker');
        setTimeout(() => lockAbove(picker, lastOpenedInput), 0);
    });

    // Keep it aligned on orientation/resize if open
    $(window).on('resize orientationchange', function () {
        if (!lastOpenedInput) return;
        const picker = lastOpenedInput.data('daterangepicker');
        if (picker && picker.isShowing) lockAbove(picker, lastOpenedInput);
    });

    // Icon clicks
    $('.dateicon, .input-group-text').on('click', function () {
        $(this).closest('.input-group').find('.datepicker').trigger('focus');
    });

    // Clear button
    $('.clear-date').on('click', function () {
        const $input = $(this).siblings('.datepicker');
        $input.val('');
        $(this).hide();
    });

    // Optional: close on scroll
    $(window).on('scroll wheel', function () {
        $('.datepicker').each(function () {
            const drp = $(this).data('daterangepicker');
            if (drp && drp.isShowing) drp.hide();
        });
    });
});


</script>
@*<script>
    $(document).ready(function () {
        $('.datepicker').daterangepicker({
            opens: 'right',
            singleDatePicker: true,
            showDropdowns: true,
            autoApply: true,
            autoUpdateInput: false,
            parentEl: '.modal',
            locale: {
                format: 'DD/MM/YYYY'
            }
        }).on('apply.daterangepicker', function (ev, picker) {
            $(this).val(picker.startDate.format('DD/MM/YYYY'));
        }).on('show.daterangepicker', function (ev, picker) {
            const $input = $(this);
            setTimeout(function () {
                const calendar = $('.daterangepicker');
                const inputOffset = $input.offset();
                const inputHeight = $input.outerHeight();
                const calendarHeight = calendar.outerHeight();
                const scrollTop = $(window).scrollTop();
                const windowHeight = $(window).height();

                const spaceBelow = windowHeight - (inputOffset.top - scrollTop + inputHeight);
                const spaceAbove = inputOffset.top - scrollTop;

                // Decide position
                const showAbove = spaceBelow < calendarHeight && spaceAbove > calendarHeight;

                // Always align left with input and open close to it
                calendar.css({
                    top: showAbove
                        ? inputOffset.top - calendarHeight - 8 + 'px'  // open just above
                        : inputOffset.top + inputHeight + 6 + 'px',     // open just below
                    left: inputOffset.left + 'px'
                });
            }, 10);
        });

        // Open calendar on icon click
        $('.input-group-text').on('click', function () {
            $(this).closest('.input-group').find('.datepicker').trigger('focus');
        });
    });

</script>*@